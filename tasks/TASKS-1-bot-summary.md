# üìä –ò–¢–û–ì–û–í–ê–Ø –°–í–û–î–ö–ê –ê–£–î–ò–¢–ê BLOCK 1: TELEGRAM –ë–û–¢

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 2026-02-16

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–¥–∞—á

**–í—Å–µ–≥–æ –∑–∞–¥–∞—á:** 19

- **[x] –°–¥–µ–ª–∞–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é:** 9 –∑–∞–¥–∞—á (47%)
  - 1.2 ‚Äî /start –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
  - 1.4 ‚Äî –ú–æ–∏ –∫–∞–Ω–∞–ª—ã
  - 1.5 ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∏
  - 1.6 ‚Äî –ü–æ–¥–¥–µ—Ä–∂–∫–∞
  - 1.7 ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞ —á–µ—Ä–µ–∑ –±–æ—Ç–∞
  - 1.8 ‚Äî –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–∞ (–æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞)
  - 1.9 ‚Äî –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–æ–∑—ã–≥—Ä—ã—à–∞
  - 1.10 ‚Äî –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—á–∞—Å—Ç–∏—è —á–µ—Ä–µ–∑ –±–æ—Ç–∞
  - 1.17 ‚Äî –ö–æ–º–∞–Ω–¥–∞ /help

- **[~] –°–¥–µ–ª–∞–Ω–æ —á–∞—Å—Ç–∏—á–Ω–æ:** 2 –∑–∞–¥–∞—á–∏ (11%)
  - 1.1 ‚Äî –ö–∞—Ä–∫–∞—Å –±–æ—Ç–∞ (–Ω–µ—Ç webhook mode, pino logging, conversations plugin)
  - 1.3 ‚Äî –°–æ–∑–¥–∞—Ç—å —Ä–æ–∑—ã–≥—Ä—ã—à (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Mini App, –≤ –±–æ—Ç–µ - –∑–∞–≥–ª—É—à–∫–∞)
  - 1.15 ‚Äî –ì–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è (–µ—Å—Ç—å, –Ω–æ –Ω–µ –≤–µ–∑–¥–µ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ)

- **[ ] –ù–µ —Å–¥–µ–ª–∞–Ω–æ:** 8 –∑–∞–¥–∞—á (42%)
  - 1.11 ‚Äî –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (BullMQ jobs) ‚Äî **–ö–†–ò–¢–ò–ß–ù–û**
  - 1.12 ‚Äî Inline mode –±–æ—Ç–∞
  - 1.13 ‚Äî –ö–æ–º–∞–Ω–¥–∞ /repost
  - 1.14 ‚Äî –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏
  - 1.16 ‚Äî –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π —á–ª–µ–Ω—Å—Ç–≤–∞ (chat_member)
  - 1.18 ‚Äî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ–∑–¥–∞—Ç–µ–ª—é –æ —É—á–∞—Å—Ç–Ω–∏–∫–∞—Ö
  - 1.19 ‚Äî –ê–¥–º–∏–Ω—Å–∫–∏–µ –±–æ—Ç-–∫–æ–º–∞–Ω–¥—ã

---

## –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –±–ª–æ–∫–∞

```
apps/bot/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ bot.ts                   (508 —Å—Ç—Ä–æ–∫) ‚Äî –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª, –≤—Å–µ handlers
‚îÇ   ‚îú‚îÄ‚îÄ server.ts                (92 —Å—Ç—Ä–æ–∫–∏) ‚Äî entrypoint, health check
‚îÇ   ‚îú‚îÄ‚îÄ config.ts                (52 —Å—Ç—Ä–æ–∫–∏) ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, whitelist
‚îÇ   ‚îú‚îÄ‚îÄ keyboards/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mainMenu.ts          (139 —Å—Ç—Ä–æ–∫) ‚Äî keyboards, messages
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ channels.ts          (452 —Å—Ç—Ä–æ–∫–∏) ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ posts.ts             (454 —Å—Ç—Ä–æ–∫–∏) ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ giveaways.ts         (515 —Å—Ç—Ä–æ–∫) ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ i18n/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.ts             (152 —Å—Ç—Ä–æ–∫–∏) ‚Äî i18n —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ messages.ts          (262 —Å—Ç—Ä–æ–∫–∏) ‚Äî –ø–µ—Ä–µ–≤–æ–¥—ã (ru/en/kk)
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îî‚îÄ‚îÄ api.ts               (378 —Å—Ç—Ä–æ–∫) ‚Äî internal API client
‚îî‚îÄ‚îÄ package.json                 ‚Äî grammy 1.21.1, dotenv
```

**–ò—Ç–æ–≥–æ:** ~3000 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

**–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç:**
- `src/jobs/` ‚Äî BullMQ workers
- `src/middleware/` ‚Äî –º–æ–¥—É–ª—å–Ω—ã–µ middleware
- `src/notifications/` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `src/admin/` ‚Äî –∞–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã

---

## –ö–ª—é—á–µ–≤—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### ‚úÖ –•–æ—Ä–æ—à–∏–µ —Ä–µ—à–µ–Ω–∏—è

1. **Separation of Concerns**
   - –ë–æ—Ç –ù–ï –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ Prisma –Ω–∞–ø—Ä—è–º—É—é
   - –í—Å—è –ª–æ–≥–∏–∫–∞ —á–µ—Ä–µ–∑ API (`/internal/*` endpoints)
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ! API = single source of truth

2. **i18n**
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 3 —è–∑—ã–∫–æ–≤ (ru/en/kk)
   - –§—É–Ω–∫—Ü–∏—è `t()` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
   - Fallback –Ω–∞ —Ä—É—Å—Å–∫–∏–π

3. **State Management**
   - In-memory states –¥–ª—è flows (channels, posts)
   - Timeout 5-10 –º–∏–Ω—É—Ç
   - –ü—Ä–æ—Å—Ç–æ–π –∏ —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø–æ–¥—Ö–æ–¥

4. **Handlers Organization**
   - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ñ—É–Ω–∫—Ü–∏—è–º (channels, posts, giveaways)
   - `registerHandlers()` pattern

5. **Whitelist Middleware**
   - –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ dev
   - ENV `ALLOWED_USERS`

### ‚ö†Ô∏è –ß—Ç–æ –Ω—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å

1. **Conversations**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è simple state –≤–º–µ—Å—Ç–æ @grammyjs/conversations
   - –†–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω–µ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö flows
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –¥–æ–±–∞–≤–∏—Ç—å conversations plugin

2. **Logging**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `console.log` / `console.error`
   - –ù–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (pino)
   - –ù–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è user actions

3. **Error Handling**
   - –ù–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ 403 (bot blocked)
   - –ù–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Channel.botIsAdmin –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
   - –ù–µ—Ç retry logic

4. **Webhook Mode**
   - –¢–æ–ª—å–∫–æ long polling
   - –ù–µ—Ç production webhook setup
   - –ù–µ—Ç ENV –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è BOT_MODE

5. **Job Scheduler**
   - –ù–µ—Ç BullMQ
   - –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è: `giveaway:start`, `giveaway:end`, `subscription:expire`

---

## –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (—Ç—Ä–µ–±—É—é—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)

### 1. Block 1.11 ‚Äî –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (BullMQ jobs) ‚Äî **–ë–õ–û–ö–ò–†–£–ï–¢ –î–†–£–ì–ò–ï –ë–õ–û–ö–ò**

**–ü–æ—á–µ–º—É –∫—Ä–∏—Ç–∏—á–Ω–æ:**
- SCHEDULED —Ä–æ–∑—ã–≥—Ä—ã—à–∏ –Ω–µ –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ü–æ–±–µ–¥–∏—Ç–µ–ª–∏ –Ω–µ –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ `endAt`
- –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–µ –∏—Å—Ç–µ–∫–∞—é—Ç
- –ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ milestone

**–ß—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç:**
- Block 12 (Winner Notification) ‚Äî –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `giveaway:end` job
- Block 6 (Payments) ‚Äî –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `subscription:expire` job
- –í–µ—Å—å flow –æ—Ç SCHEDULED ‚Üí ACTIVE ‚Üí FINISHED

**–û—Ü–µ–Ω–∫–∞:** 2-3 –¥–Ω—è (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ BullMQ, —Å–æ–∑–¥–∞–Ω–∏–µ workers, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Redis)

### 2. Block 1.1 ‚Äî Webhook Mode –¥–ª—è Production

**–ü–æ—á–µ–º—É –∫—Ä–∏—Ç–∏—á–Ω–æ:**
- Long polling –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è production (–Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ, –≤—ã—Å–æ–∫–∏–π latency)
- –ù—É–∂–µ–Ω webhook –¥–ª—è high availability

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- ENV `BOT_MODE=webhook|polling`
- `bot.api.setWebhook()` –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å endpoint –∏–∑ Block 10: `/webhooks/telegram/:botToken`

**–û—Ü–µ–Ω–∫–∞:** 1 –¥–µ–Ω—å

### 3. Block 1.14 ‚Äî –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–æ—Å—Ç–∞–≤–∫–∏

**–ü–æ—á–µ–º—É –∫—Ä–∏—Ç–∏—á–Ω–æ:**
- –ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –±–æ—Ç–∞ —é–∑–µ—Ä–æ–º ‚Äî –ø–æ–ø—ã—Ç–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è
- –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ –ø—Ä–∞–≤ –≤ –∫–∞–Ω–∞–ª–µ ‚Äî –Ω–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- Global error handler –¥–ª—è 403
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ User.notificationsBlocked
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Channel.botIsAdmin

**–û—Ü–µ–Ω–∫–∞:** 1-2 –¥–Ω—è

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ –¥—Ä—É–≥–∏–µ –±–ª–æ–∫–∏

### –ë–æ—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç:
- **Block 0 (Setup):** Prisma models, Redis (–¥–ª—è BullMQ)
- **Block 10 (API):** Internal endpoints (`/internal/*`)
- **Block 7 (Security):** Subscription check endpoint

### –î—Ä—É–≥–∏–µ –±–ª–æ–∫–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç Bot:
- **Block 12 (Winner Notification):** –¢—Ä–µ–±—É–µ—Ç `giveaway:end` job –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **Block 2, 4 (Mini App):** Deep links (`/start confirm_{id}`, `/start join_{id}`)
- **Block 6 (Payments):** `subscription:expire` job
- **Block 8 (Catalog):** –ê–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã (`/admin_approve`, `/admin_reject`)

---

## –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

### ‚ùå –ö–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ

–í—Å–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã —Å:
- Prisma –º–æ–¥–µ–ª—è–º–∏ (Block 0)
- API endpoints (Block 10)
- Shared types (`@randombeast/shared`)

### ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ—Ç–ª–∏—á–∏—è (–Ω–µ —è–≤–ª—è—é—Ç—Å—è –æ—à–∏–±–∫–∞–º–∏):

1. **–ë–æ—Ç –Ω–µ —Å–æ–∑–¥–∞–µ—Ç User –Ω–∞–ø—Ä—è–º—É—é**
   - –û–ø–∏—Å–∞–Ω–∏–µ: "–°–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å —é–∑–µ—Ä–∞ –≤ –ë–î" (–∑–∞–¥–∞—á–∞ 1.2)
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: –Æ–∑–µ—Ä —Å–æ–∑–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ API –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ –∏–∑ Mini App
   - –†–µ—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ (API ‚Äî single source of truth)

2. **Deep link `confirm_` –≤–º–µ—Å—Ç–æ `g_`**
   - –û–ø–∏—Å–∞–Ω–∏–µ: `/start g_{giveawayId}`
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: `/start confirm_{giveawayId}` (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è)
   - –ò –æ—Ç–¥–µ–ª—å–Ω–æ: `/start join_{giveawayId}` (—É—á–∞—Å—Ç–∏–µ)
   - –†–µ—à–µ–Ω–∏–µ –ª–æ–≥–∏—á–Ω–æ–µ (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ concern)

3. **–°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∞ —Ç–æ–ª—å–∫–æ –≤ Mini App**
   - –û–ø–∏—Å–∞–Ω–∏–µ: Conversation flow –≤ –±–æ—Ç–µ (–∑–∞–¥–∞—á–∞ 1.3)
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ: –ó–∞–≥–ª—É—à–∫–∞ "—Å–∫–æ—Ä–æ" (–≤—Å—è –ª–æ–≥–∏–∫–∞ –≤ Mini App)
   - –†–µ—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ (UI —É–¥–æ–±–Ω–µ–µ –¥–ª—è —Å–ª–æ–∂–Ω–æ–≥–æ wizard)

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö–†–ò–¢–ò–ß–ù–û ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–Ω–∞—á–∞–ª–∞):

1. **Block 1.11 ‚Äî BullMQ jobs** (–±–ª–æ–∫–∏—Ä—É–µ—Ç Block 12, 6)
   ```bash
   cd apps/bot
   pnpm add bullmq ioredis
   ```
   –°–æ–∑–¥–∞—Ç—å:
   - `src/jobs/queue.ts` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Queue/Worker
   - `src/jobs/giveaway-start.ts` ‚Äî –ø—É–±–ª–∏–∫–∞—Ü–∏—è SCHEDULED
   - `src/jobs/giveaway-end.ts` ‚Äî –≤—ã–±–æ—Ä –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–π
   - `src/jobs/subscription-expire.ts` ‚Äî –∏—Å—Ç–µ—á–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫
   - `src/jobs/channel-update-subscribers.ts` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ subscriberCount

2. **Block 1.1 ‚Äî Webhook mode**
   - –î–æ–±–∞–≤–∏—Ç—å ENV `BOT_MODE`
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `bot.api.setWebhook()` –¥–ª—è production
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `/webhooks/telegram/:botToken` –∏–∑ Block 10

3. **Block 1.14 ‚Äî Error handling**
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ 403 (bot blocked) ‚Üí `User.notificationsBlocked=true`
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ publish errors ‚Üí `Channel.botIsAdmin=false`

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–°–†–ï–î–ù–ò–ô ‚Äî —É–ª—É—á—à–µ–Ω–∏—è):

4. **Block 1.16 ‚Äî chat_member events**
   - `bot.on("my_chat_member")` –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `Channel.botIsAdmin`

5. **Block 1.18 ‚Äî Milestone —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
   - BullMQ job `creator:milestone`
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ `User.creatorNotificationMode`

6. **Logging & Monitoring**
   ```bash
   pnpm add pino pino-pretty
   ```
   - –ó–∞–º–µ–Ω–∏—Ç—å `console.log` –Ω–∞ `pino`
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ user actions

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (LOW ‚Äî nice-to-have):

7. **Block 1.12 ‚Äî Inline mode**
8. **Block 1.19 ‚Äî –ê–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã**
9. **Conversations plugin**
   ```bash
   pnpm add @grammyjs/conversations
   ```

---

## –°–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫ –¥–ª—è –∞—É–¥–∏—Ç–∞

**TASKS-2-miniapp.md** (Mini App –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤)

**–ü–æ—á–µ–º—É:**
- Block 1 (Bot) ‚Üí Block 2 (Mini App) ‚Äî –ø—Ä—è–º–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
- Deep links –∏–∑ –±–æ—Ç–∞ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç Mini App
- –£—á–∞—Å—Ç–∏–µ –≤ —Ä–æ–∑—ã–≥—Ä—ã—à–∞—Ö –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ Mini App

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ:**
- **TASKS-12-notifications.md** (–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–±–µ–¥–∏—Ç–µ–ª—è–º) ‚Äî –∑–∞–≤–∏—Å–∏—Ç –æ—Ç Block 1.11

---

## –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ Block 1

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** ‚úÖ **7/10** (—Ö–æ—Ä–æ—à–æ, –Ω–æ –Ω–µ –∑–∞–∫–æ–Ω—á–µ–Ω)

**–ü–ª—é—Å—ã:**
- ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç–∞–µ—Ç (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤, –ø–æ—Å—Ç–æ–≤, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π)
- ‚úÖ –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (separation of concerns)
- ‚úÖ i18n, whitelist, graceful shutdown
- ‚úÖ –•–æ—Ä–æ—à–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞ (handlers, services)

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù–µ—Ç BullMQ (–∫—Ä–∏—Ç–∏—á–Ω–æ!)
- ‚ùå –¢–æ–ª—å–∫–æ long polling (–Ω–µ—Ç webhook)
- ‚ùå –ù–µ—Ç error handling –¥–ª—è 403/–ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- ‚ùå –ü—Ä–æ—Å—Ç–æ–π state management (–Ω–µ—Ç conversations plugin)

**–í—ã–≤–æ–¥:**
–ë–æ—Ç **—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –¥–ª—è MVP**, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á (BullMQ, webhook, error handling) –ø–µ—Ä–µ–¥ production.
